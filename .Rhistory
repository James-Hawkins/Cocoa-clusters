fig.si.leg.key.h <- 0.34
fig.si.leg.key.w <- 0.34
fig.si.leg.space.x <- 0.2
fig.si.leg.space.y <- 0.15
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
fig.si <<- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System) , shape = fig.si.point.type , size  = fig.si.point.size  )+
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = 9 , color = 'black' , face = 'italic'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y, 'cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 488, height = 420, units="px", scale=2.5)
}
gen.si.fig()
gen.si.fig <- function(){
fig.si.ytit.fs <- 11.0
fig.si.x.lab.fs <- 9.0
fig.si.facet.fs  <- 8.0
fig.si.point.type <- 15
fig.si.point.size <- .98
fig.si.leg.x.coord <- 0.2735
fig.si.leg.y.coord  <- 0.26
fig.si.leg.key.h <- 1.34
fig.si.leg.key.w <- 1.34
fig.si.leg.space.x <- 0.2
fig.si.leg.space.y <- 0.15
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
fig.si <<- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System) , shape = fig.si.point.type , size  = fig.si.point.size  )+
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = 9 , color = 'black' , face = 'italic'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y*0, 'cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 488, height = 420, units="px", scale=2.5)
}
gen.si.fig()
gen.si.fig <- function(){
fig.si.ytit.fs <- 11.0
fig.si.x.lab.fs <- 9.0
fig.si.facet.fs  <- 8.0
fig.si.point.type <- 15
fig.si.point.size <- .98
fig.si.leg.x.coord <- 0.2735
fig.si.leg.y.coord  <- 0.26
fig.si.leg.key.h <- 0.34
fig.si.leg.key.w <- 0.34
fig.si.leg.space.x <- 0.2
fig.si.leg.space.y <- 0.15
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
fig.si <<- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System) , shape = fig.si.point.type , size  = fig.si.point.size  )+
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = 9 , color = 'black' , face = 'italic'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y*0, 'cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 488, height = 420, units="px", scale=2.5)
}
gen.si.fig()
save.image('cocoa.typology.SA.aug7.RData')
main.dir <<- file.path("C:", "Users", "hawkj", "Documents" ,"Github", "MFL", "Survey", "GML_survey" )       # Create directory path
cc.typ.dir <<- file.path("C:", "Users", "hawkj", "Documents" ,"Github", "MFL", "Survey", "GML_survey" , "Hierarchical-cocoa-clustering-script" )       # Create directory path
cc.typ.dir.out <<- file.path("C:", "Users", "hawkj", "Documents" ,"Github", "MFL", "Survey", "GML_survey" , "Hierarchical-cocoa-clustering-script" , "Figures.out" )       # Create directory path
packages.load()
run.typology()
var <- 'lc.N2O.synthetic.total.Mg.CO2eq'
summary(comp[ comp$typology == typ & !is.na(comp$typ),var])
summary(comp[  !is.na(comp$typ),var])
sd(na.omit(comp[ !is.na(comp$typ),var]))
#var <- 'elev'
# var <- 'precip'
#  var <- 'insecti.app.cocoa'
#  var <- 'fungi.app.cocoa'
# var <- 'herbi.app.cocoa'
# var <- 'pollination.bool'
var <- 'lc.GHG.remv.cc.Mg.CO2eq.ha.yr'
summary(comp[  !is.na(comp$typ),var])
sd(na.omit(comp[ !is.na(comp$typ),var]))
# Compare total ghg to Vervurrt
3179.3/ ((-5)*443) # absolute deviation of total CO2
var
var <- 'lc.GHG.remv.C.Mg.CO2eq'
summary(comp[ comp$typology == typ & !is.na(comp$typ),var])
# Compare total ghg to Vervurrt
3771/ ((-5)*443) # absolute deviation of total CO2
main.dir <<- file.path("C:", "Users", "hawkj", "Documents" ,"Github", "MFL", "Survey", "GML_survey" )       # Create directory path
cc.typ.dir <<- file.path("C:", "Users", "hawkj", "Documents" ,"Github", "MFL", "Survey", "GML_survey" , "Hierarchical-cocoa-clustering-script" )       # Create directory path
cc.typ.dir.out <<- file.path("C:", "Users", "hawkj", "Documents" ,"Github", "MFL", "Survey", "GML_survey" , "Hierarchical-cocoa-clustering-script" , "Figures.out" )       # Create directory path
packages.load()
var
summary(comp[  !is.na(comp$typ),var])
var <- 'lc.N2O.synthetic.total.Mg.CO2eq'
summary(comp[  !is.na(comp$typ),var])
sd(na.omit(comp[ !is.na(comp$typ),var]))
summary(comp[  !is.na(comp$typ),var])
var <- 'lc.N2O.organic.total.Mg.CO2eq'
summary(comp[  !is.na(comp$typ),var])
0.13 + 0.054719
(0.13 + 0.054719) *1000 * cv.N2O.to.CO2eq
cv.N2O.to.CO2eq
cv.N2O.to.CO2eq
(0.13 + 0.054719) *1000 * /cv.N2O.to.CO2eq
(0.13 + 0.054719) *1000 /cv.N2O.to.CO2eq
((0.13 + 0.054719) *1000 /cv.N2O.to.CO2eq ) / 1.5711
0.85 * 1.5711
((0.13 + 0.054719) *1000 /cv.N2O.to.CO2eq )
((0.133 + 0.054719) *1000 /cv.N2O.to.CO2eq )
0.75 * 1.5711
((0.133 + 0.054719) *1000 /cv.N2O.to.CO2eq )
cv.N2O.to.CO2eq
cv.N2O.to.CO2eq <<- 273
cv.N2O.to.CO2eq
((0.133 + 0.054719) *1000 /cv.N2O.to.CO2eq )
((0.133 + 0.054719) *1000 /cv.N2O.to.CO2eq )
((0.133 + 0.054719) *1000 /265 )
((0.133 + 0.054719) *1000 /265 )
0.75 * 1.5711
((0.133 + 0.054719) *1000 /265 )
((0.133 + 0.054719) *1000 /265 )
1.17/ ((0.133 + 0.054719) *1000 /265 )
((0.133 + 0.054719) *1000 /265 )
((0.133 + 0.054719) *1000 /265 )
var <- 'lc.N2O.synthetic.total.Mg.CO2eq'
var1 <- 'lc.N2O.organic.total.Mg.CO2eq'
mean(comp[  !is.na(comp$typ),var] + comp[  !is.na(comp$typ),var1])
mean(na.omit(comp[  !is.na(comp$typ),var]) + comp[  !is.na(comp$typ),var1])
mean(na.omit(comp[  !is.na(comp$typ),var]) + na.omit(comp[  !is.na(comp$typ),var1])
# synth n2o 0.133, org 0.05
1.17/ ((0.133 + 0.054719) *1000 /265 )
mean(na.omit(comp[  !is.na(comp$typ),var]) + na.omit(comp[  !is.na(comp$typ),var1]))
var1
var <- 'lc.N2O.synthetic.total.Mg.CO2eq'
mean(na.omit(comp[  !is.na(comp$typ),var]) + na.omit(comp[  !is.na(comp$typ),var1]))
summary(comp[ comp$typology == typ & !is.na(comp$typ),var])
summary(comp[ comp$typology == typ & !is.na(comp$typ),var])
var <- 'lc.N2O.synthetic.total.Mg.CO2eq'
summary(comp[  !is.na(comp$typ),var])
var
packages.load()
gen.si.fig <- function(){
setwd(cc.typ.dir)
fig.si.ytit.fs <- 10.0
fig.si.x.lab.fs <- 8.5
fig.si.facet.fs  <- 9.5
fig.si.point.type <- 15
fig.si.point.size <- 1.4386 # 1.2
fig.si.leg.text.fs <- 11.0
fig.si.leg.x.coord <- 0.745
fig.si.leg.y.coord  <- 0.082
fig.si.leg.key.h <- 0.48
fig.si.leg.key.w <- 0.48
fig.si.leg.space.x <- 0.08
fig.si.leg.space.y <- -1.05
leg.key.size <- 2
x.jit <- 0.4
rel.pan.size.1 <- 0.4465
rel.pan.size.2 <-   1 - rel.pan.size.1
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
group.colors <- c(  "#dc143c",
"#228b22",
"#126180")
group.sizes <-  c( 5,3,1)
group.shapes <-  c( 0,1,2)
group.shapes <-  c( 16,15,17)
fig.si <- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System , shape = System  ) , alpha = 0.55 , size = fig.si.point.size#, shape = fig.si.point.type , size  = fig.si.point.size
#,position = position_jitter(h=0.0,w = x.jit)
)  +
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
force_panelsizes(cols = c(rel.pan.size.1, rel.pan.size.2)) +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
scale_size_manual(values=group.sizes)+
scale_shape_manual(values=group.shapes)+
guides(color = guide_legend(override.aes = list(size=leg.key.size)))+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = fig.si.leg.text.fs , color = 'black' , face = 'italic'),
#legend.key.size = unit(fig.si.leg.key.w * 4.9, 'cm'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y, 'cm'),
legend.margin = margin(t = 0, unit='cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
fig.si <- plot_grid( fig.si ,
align = "h",
nrow = 1,
ncol = 1 ,
rel_widths = c(10/100, 70/100))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 612, height = 390, units="px", scale=2.5)
fig.si <<-fig.si
}
gen.si.fig()
gen.si.fig <- function(){
setwd(cc.typ.dir)
fig.si.ytit.fs <- 10.0
fig.si.x.lab.fs <- 8.5
fig.si.facet.fs  <- 9.5
fig.si.point.type <- 15
fig.si.point.size <- 1.4386 # 1.2
fig.si.leg.text.fs <- 11.0
fig.si.leg.x.coord <- 0.745
fig.si.leg.y.coord  <- 0.082
fig.si.leg.key.h <- 0.48
fig.si.leg.key.w <- 0.48
fig.si.leg.space.x <- 0.08
fig.si.leg.space.y <- -1.05
leg.key.size <- 4
x.jit <- 0.4
rel.pan.size.1 <- 0.4465
rel.pan.size.2 <-   1 - rel.pan.size.1
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
group.colors <- c(  "#dc143c",
"#228b22",
"#126180")
group.sizes <-  c( 5,3,1)
group.shapes <-  c( 0,1,2)
group.shapes <-  c( 16,15,17)
fig.si <- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System , shape = System  ) , alpha = 0.55 , size = fig.si.point.size#, shape = fig.si.point.type , size  = fig.si.point.size
#,position = position_jitter(h=0.0,w = x.jit)
)  +
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
force_panelsizes(cols = c(rel.pan.size.1, rel.pan.size.2)) +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
scale_size_manual(values=group.sizes)+
scale_shape_manual(values=group.shapes)+
guides(color = guide_legend(override.aes = list(size=leg.key.size)))+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = fig.si.leg.text.fs , color = 'black' , face = 'italic'),
#legend.key.size = unit(fig.si.leg.key.w * 4.9, 'cm'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y, 'cm'),
legend.margin = margin(t = 0, unit='cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
fig.si <- plot_grid( fig.si ,
align = "h",
nrow = 1,
ncol = 1 ,
rel_widths = c(10/100, 70/100))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 612, height = 390, units="px", scale=2.5)
fig.si <<-fig.si
}
gen.si.fig()
gen.si.fig <- function(){
setwd(cc.typ.dir)
fig.si.ytit.fs <- 10.0
fig.si.x.lab.fs <- 8.5
fig.si.facet.fs  <- 9.5
fig.si.point.type <- 15
fig.si.point.size <- 2.4386 # 1.2
fig.si.leg.text.fs <- 11.0
fig.si.leg.x.coord <- 0.745
fig.si.leg.y.coord  <- 0.082
fig.si.leg.key.h <- 0.48
fig.si.leg.key.w <- 0.48
fig.si.leg.space.x <- 0.08
fig.si.leg.space.y <- -1.05
leg.key.size <- 2
x.jit <- 0.4
rel.pan.size.1 <- 0.4465
rel.pan.size.2 <-   1 - rel.pan.size.1
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
group.colors <- c(  "#dc143c",
"#228b22",
"#126180")
group.sizes <-  c( 5,3,1)
group.shapes <-  c( 0,1,2)
group.shapes <-  c( 16,15,17)
fig.si <- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System , shape = System  ) , alpha = 0.55 , size = fig.si.point.size#, shape = fig.si.point.type , size  = fig.si.point.size
#,position = position_jitter(h=0.0,w = x.jit)
)  +
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
force_panelsizes(cols = c(rel.pan.size.1, rel.pan.size.2)) +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
scale_size_manual(values=group.sizes)+
scale_shape_manual(values=group.shapes)+
guides(color = guide_legend(override.aes = list(size=leg.key.size)))+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = fig.si.leg.text.fs , color = 'black' , face = 'italic'),
#legend.key.size = unit(fig.si.leg.key.w * 4.9, 'cm'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y, 'cm'),
legend.margin = margin(t = 0, unit='cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
fig.si <- plot_grid( fig.si ,
align = "h",
nrow = 1,
ncol = 1 ,
rel_widths = c(10/100, 70/100))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 612, height = 390, units="px", scale=2.5)
fig.si <<-fig.si
}
gen.si.fig()
gen.si.fig <- function(){
setwd(cc.typ.dir)
fig.si.ytit.fs <- 10.0
fig.si.x.lab.fs <- 8.5
fig.si.facet.fs  <- 9.5
fig.si.point.type <- 15
fig.si.point.size <- 2.004386 # 1.2
fig.si.leg.text.fs <- 11.0
fig.si.leg.x.coord <- 0.745
fig.si.leg.y.coord  <- 0.082
fig.si.leg.key.h <- 0.48
fig.si.leg.key.w <- 0.48
fig.si.leg.space.x <- 0.08
fig.si.leg.space.y <- -1.05
leg.key.size <- 2
x.jit <- 0.4
rel.pan.size.1 <- 0.4465
rel.pan.size.2 <-   1 - rel.pan.size.1
ordered.labels <- si.var.labs
SI.df$Label <- factor(SI.df$Label ,ordered.labels )
ordered.systems <- c('Hybrid sun' , 'Hybrid shade' , 'Amazonia')
SI.df$System <- factor(SI.df$System ,ordered.systems )
group.colors <- c(  "#af7ac5",
"#6c3483",
"#f39c12")
group.colors <- c(  "#dc143c",
"#228b22",
"#126180")
group.sizes <-  c( 5,3,1)
group.shapes <-  c( 0,1,2)
group.shapes <-  c( 16,15,17)
fig.si <- ggplot(data = SI.df[SI.df$System != 'All',], aes(x = Label, y = SI )) +
geom_point(aes(x = Label , y = SI , color = System , shape = System  ) , alpha = 0.55 , size = fig.si.point.size#, shape = fig.si.point.type , size  = fig.si.point.size
#,position = position_jitter(h=0.0,w = x.jit)
)  +
facet_wrap( Impact_ind_str ~ . , ncol = 2, nrow = 1, scales = 'free_x' )   +
force_panelsizes(cols = c(rel.pan.size.1, rel.pan.size.2)) +
scale_y_continuous(breaks = seq(-1,1,.5),limit = c(-1,1) ,  labels = scales::number_format(accuracy = 0.1))+
ylab('Sensitivity index')+
scale_color_manual(values=group.colors)+
scale_size_manual(values=group.sizes)+
scale_shape_manual(values=group.shapes)+
guides(color = guide_legend(override.aes = list(size=leg.key.size)))+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = fig.si.ytit.fs , color = 'black'),
strip.text.x = element_text(size = fig.si.facet.fs , color = 'black'),
axis.ticks.x =  element_blank(),
legend.title = element_blank(),
legend.key = element_blank(),
legend.text = element_text(size = fig.si.leg.text.fs , color = 'black' , face = 'italic'),
#legend.key.size = unit(fig.si.leg.key.w * 4.9, 'cm'),
legend.key.height = unit(fig.si.leg.key.h, 'cm'),
legend.key.width = unit(fig.si.leg.key.w, 'cm'),
legend.spacing.x = unit(fig.si.leg.space.x, 'cm'),
legend.spacing.y = unit(fig.si.leg.space.y, 'cm'),
legend.margin = margin(t = 0, unit='cm'),
legend.position = c(fig.si.leg.x.coord , fig.si.leg.y.coord ) ,
axis.text.x = element_text(angle = x.tick.angle , vjust = .5 , hjust = 0 , size = fig.si.x.lab.fs , face = 'italic' ),
strip.background = element_rect(color='black', fill='white', size=1.0, linetype="solid"),
panel.border = element_rect(colour = "black", fill=NA, size=1))
fig.si <- plot_grid( fig.si ,
align = "h",
nrow = 1,
ncol = 1 ,
rel_widths = c(10/100, 70/100))
ggsave("fig.si.pdf",   fig.si    , path = cc.typ.dir.out, width = 460, height = 490, units="px", scale=2.5)
ggsave("fig.si.jpg",   fig.si    , path = cc.typ.dir.out, width = 612, height = 390, units="px", scale=2.5)
fig.si <<-fig.si
}
gen.si.fig()
